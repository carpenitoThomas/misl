reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable, color = "black" ))  +
geom_histogram(alpha = .4, position = 'identity') +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable, color = black ))  +
geom_histogram(alpha = .4, position = 'identity') +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))  +
geom_histogram(alpha = .4, position = 'identity') +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))  +
geom_histogram(alpha = .4, position = 'dodge') +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))  +
geom_histogram(alpha = .4, position = 'identity') +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))  +
geom_histogram(alpha = .2, position = 'identity') +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
?geom_histogram
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))  +
geom_histogram(alpha = .2, position = 'stack') +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value)
a
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value)  +
geom_histogram(alpha = .2, position = 'stack')
a
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value))+
geom_histogram(alpha = .2, position = 'stack')
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value))+
geom_histogram(alpha = .2, position = 'stack') +
facet_grid(.~variable)
abalone_imputations <- data.frame(original = abalone_model_predictions$Length, problem = large_se_df_1$misl_imp[[4]]$datasets$Length[-1], non_problem1 = large_se_df_1$misl_imp[[1]]$datasets$Length[-1], non_problem2 = large_se_df_1$misl_imp[[2]]$datasets$Length[-1], non_problem3 = large_se_df_1$misl_imp[[3]]$datasets$Length[-1] imputed =missing_NA[-1] )
abalone_imputations <- data.frame(original = abalone_model_predictions$Length, problem = large_se_df_1$misl_imp[[4]]$datasets$Length[-1], non_problem1 = large_se_df_1$misl_imp[[1]]$datasets$Length[-1], non_problem2 = large_se_df_1$misl_imp[[2]]$datasets$Length[-1], non_problem3 = large_se_df_1$misl_imp[[3]]$datasets$Length[-1] imputed =missing_NA[-1] )
abalone_imputations <- data.frame(original = abalone_model_predictions$Length, problem = large_se_df_1$misl_imp[[4]]$datasets$Length[-1], non_problem1 = large_se_df_1$misl_imp[[1]]$datasets$Length[-1], non_problem2 = large_se_df_1$misl_imp[[2]]$datasets$Length[-1], non_problem3 = large_se_df_1$misl_imp[[3]]$datasets$Length[-1], imputed =missing_NA[-1] )
reshaped <- melt(abalone_imputations)
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value))+
geom_histogram(alpha = .2, position = 'stack') +
facet_grid(.~variable)
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value))+
geom_histogram(alpha = .2, position = 'stack') +
facet_grid(.~variable)
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(!imputed) %>%
ggplot(aes(x =value))+
geom_histogram(alpha = .2, position = 'stack') +
facet_grid(.~variable) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value))+
geom_histogram(alpha = .2, position = 'stack') +
facet_grid(.~variable) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram(alpha = .2, position = 'stack') +
facet_grid(.~variable) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(.~variable) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(.~variable) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(variable) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
abalone_imputations <- data.frame(original = abalone_model_predictions$Length, problem = large_se_df_1$misl_imp[[4]]$datasets$Length[-1], non_problem1 = large_se_df_1$misl_imp[[1]]$datasets$Length[-1], non_problem2 = large_se_df_1$misl_imp[[2]]$datasets$Length[-1], non_problem3 = large_se_df_1$misl_imp[[5]]$datasets$Length[-1], imputed =missing_NA[-1] )
reshaped <- melt(abalone_imputations)
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
abalone_imputations <- data.frame(original = abalone_model_predictions$Length, problem = large_se_df_1$misl_imp[[4]]$datasets$Length[-1], non_problem1 = large_se_df_1$misl_imp[[1]]$datasets$Length[-1], non_problem2 = large_se_df_1$misl_imp[[2]]$datasets$Length[-1], non_problem3 = large_se_df_1$misl_imp[[3]]$datasets$Length[-1], non_problem3 = large_se_df_1$misl_imp[[5]]$datasets$Length[-1], imputed =missing_NA[-1] )
reshaped <- melt(abalone_imputations)
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
abalone_imputations <- data.frame(original = abalone_model_predictions$Length, non_problem1 = large_se_df_1$misl_imp[[1]]$datasets$Length[-1], non_problem2 = large_se_df_1$misl_imp[[2]]$datasets$Length[-1], non_problem3 = large_se_df_1$misl_imp[[3]]$datasets$Length[-1], problem = large_se_df_1$misl_imp[[4]]$datasets$Length[-1], non_problem3 = large_se_df_1$misl_imp[[5]]$datasets$Length[-1], imputed =missing_NA[-1] )
reshaped <- melt(abalone_imputations)
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
group_by(variable) %>%
summarise(mean = mean(value), sd = sd(value))
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_boxplot() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
abalone_imputations <- data.frame(original = abalone_model_predictions$Length, non_problem1 = large_se_df_1$misl_imp[[1]]$datasets$Length[-1], non_problem2 = large_se_df_1$misl_imp[[2]]$datasets$Length[-1], non_problem3 = large_se_df_1$misl_imp[[3]]$datasets$Length[-1], problem4 = large_se_df_1$misl_imp[[4]]$datasets$Length[-1], non_problem5 = large_se_df_1$misl_imp[[5]]$datasets$Length[-1], imputed =missing_NA[-1] )
reshaped <- melt(abalone_imputations)
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
group_by(variable) %>%
summarise(mean = mean(value), sd = sd(value))
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_boxplot() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
misl_fit_no_prob <- lapply(large_se_df_1$misl_imp[c(1:3,5)], function(y){
lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12, data = y$datasets)
})
misl_pool_no_prob <- mice::pool(misl_fit_no_prob)
misl_pool_no_prob_summary <- summary(mice::pool(misl_fit_no_prob), conf.int = TRUE)
misl_pool_no_prob_summary
misl_fit_no_prob <- lapply(large_se_df_1$misl_imp[c(1:2,5)], function(y){
lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12, data = y$datasets)
})
misl_pool_no_prob <- mice::pool(misl_fit_no_prob)
misl_pool_no_prob_summary <- summary(mice::pool(misl_fit_no_prob), conf.int = TRUE)
misl_pool_no_prob_summary
misl_fit_no_prob <- lapply(large_se_df_1$misl_imp[c(1:4,5)], function(y){
lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12, data = y$datasets)
})
misl_pool_no_prob <- mice::pool(misl_fit_no_prob)
misl_pool_no_prob_summary <- summary(mice::pool(misl_fit_no_prob), conf.int = TRUE)
misl_pool_no_prob_summary
abalone_imputations <- data.frame(original = abalone_model_predictions$Length, non_problem1 = large_se_df_1$misl_imp[[1]]$datasets$Length[-1], non_problem2 = large_se_df_1$misl_imp[[2]]$datasets$Length[-1], non_problem3 = large_se_df_1$misl_imp[[3]]$datasets$Length[-1], problem4 = large_se_df_1$misl_imp[[4]]$datasets$Length[-1], non_problem4 = large_se_df_1$misl_imp[[5]]$datasets$Length[-1], imputed =missing_NA[-1] )
reshaped <- melt(abalone_imputations)
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
group_by(variable) %>%
summarise(mean = mean(value), sd = sd(value))
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_boxplot() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
group_by(variable) %>%
summarise(mean = mean(value), sd = sd(value))
reshaped %>%
ggplot(aes(x =value, fill = variable))+
geom_boxplot() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
reshaped %>%
filter(imputed) %>%
group_by(variable) %>%
summarise(mean = mean(value), sd = sd(value))
reshaped %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_boxplot() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
misl_fit_no_prob <- lapply(large_se_df_1$misl_imp[c(1:3,5)], function(y){
lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12, data = y$datasets)
})
lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12, data = large_se_df_1$misl_imp[[3]]$datasets)
model_4 <- lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12, data = large_se_df_1$misl_imp[[4]]$datasets)
model_4
hist(large_se_df_1$misl_imp[[3]]$datasets$Length)
View(abalone_model_predictions)
View(abalone_model_predictions)
dataset_original <- data.frame(dataset = "original", Sex = abalone_model_predictions$Sex, Length = abalone_model_predictions$Length , Diameter =  abalone_model_predictions$Diameter, Height = abalone_model_predictions$Height , Older_12= abalone_model_predictions$Older_12, Whole_Weight_Pred = abalone_model_predictions$Whole_Weight_Pred )
dataset_original
View(dataset_original)
View(melt(dataset_original))
melt(dataset_original, id = dataset)
View(melt(dataset_original, id = "dataset"))
dataset_original <- data.frame(dataset = "original", Length = abalone_model_predictions$Length , Diameter =  abalone_model_predictions$Diameter, Height = abalone_model_predictions$Height , Older_12= abalone_model_predictions$Older_12, Whole_Weight_Pred = abalone_model_predictions$Whole_Weight_Pred )
melt(dataset_original, id = "dataset")
View(melt(dataset_original, id = "dataset"))
imputed_1 <- imputed_1 <- data.frame(dataset = "original", Length = large_se_df_1$misl_imp[[3]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[3]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[3]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[3]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[3]]$datasets$Whole_Weight_Pred[-1])
View(imputed_1)
imputed_1 <- imputed_1 <- data.frame(dataset = "imputed_1", Length = large_se_df_1$misl_imp[[1]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[1]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[1]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[1]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[1]]$datasets$Whole_Weight_Pred[-1])
dataset_original <- data.frame(dataset = "original", Length = abalone_model_predictions$Length , Diameter =  abalone_model_predictions$Diameter, Height = abalone_model_predictions$Height , Older_12= abalone_model_predictions$Older_12, Whole_Weight_Pred = abalone_model_predictions$Whole_Weight_Pred )
imputed_1 <- data.frame(dataset = "imputed_1", Length = large_se_df_1$misl_imp[[1]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[1]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[1]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[1]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[1]]$datasets$Whole_Weight_Pred[-1])
imputed_2 <- data.frame(dataset = "imputed_2", Length = large_se_df_1$misl_imp[[2]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[2]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[2]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[2]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[2]]$datasets$Whole_Weight_Pred[-1])
imputed_3 <- data.frame(dataset = "imputed_3", Length = large_se_df_1$misl_imp[[3]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[3]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[3]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[3]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[3]]$datasets$Whole_Weight_Pred[-1])
imputed_4 <- data.frame(dataset = "imputed_4", Length = large_se_df_1$misl_imp[[4]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[4]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[4]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[4]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[4]]$datasets$Whole_Weight_Pred[-1])
imputed_5 <- data.frame(dataset = "imputed_5", Length = large_se_df_1$misl_imp[[5]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[5]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[5]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[5]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[5]]$datasets$Whole_Weight_Pred[-1])
combined_all <- rbind(melt(dataset_original, id = "dataset"), melt(imputed_1, id = "dataset"), melt(imputed_2, id = "dataset"), melt(imputed_3, id = "dataset"), melt(imputed_4, id = "dataset"),melt(imputed_5, id = "dataset") )
nrow(combined_all)
View(combined_all)
combined_all %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
combined_all %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram()
dataset_original <- data.frame(dataset = "original", Length = abalone_model_predictions$Length , Diameter =  abalone_model_predictions$Diameter, Height = abalone_model_predictions$Height , Older_12= abalone_model_predictions$Older_12, Whole_Weight_Pred = abalone_model_predictions$Whole_Weight_Pred, imputed =missing_NA[-1] )
imputed_1 <- data.frame(dataset = "imputed_1", Length = large_se_df_1$misl_imp[[1]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[1]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[1]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[1]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[1]]$datasets$Whole_Weight_Pred[-1], imputed =missing_NA[-1])
imputed_2 <- data.frame(dataset = "imputed_2", Length = large_se_df_1$misl_imp[[2]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[2]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[2]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[2]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[2]]$datasets$Whole_Weight_Pred[-1], imputed =missing_NA[-1])
imputed_3 <- data.frame(dataset = "imputed_3", Length = large_se_df_1$misl_imp[[3]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[3]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[3]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[3]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[3]]$datasets$Whole_Weight_Pred[-1], imputed =missing_NA[-1])
imputed_4 <- data.frame(dataset = "imputed_4", Length = large_se_df_1$misl_imp[[4]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[4]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[4]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[4]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[4]]$datasets$Whole_Weight_Pred[-1], imputed =missing_NA[-1])
imputed_5 <- data.frame(dataset = "imputed_5", Length = large_se_df_1$misl_imp[[5]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[5]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[5]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[5]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[5]]$datasets$Whole_Weight_Pred[-1], imputed =missing_NA[-1])
combined_all <- rbind(melt(dataset_original, id = "dataset"), melt(imputed_1, id = "dataset"), melt(imputed_2, id = "dataset"), melt(imputed_3, id = "dataset"), melt(imputed_4, id = "dataset"),melt(imputed_5, id = "dataset") )
combined_all %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
View(combined_all)
dataset_original <- data.frame(dataset = "original", Length = abalone_model_predictions$Length , Diameter =  abalone_model_predictions$Diameter, Height = abalone_model_predictions$Height , Older_12= abalone_model_predictions$Older_12, Whole_Weight_Pred = abalone_model_predictions$Whole_Weight_Pred, imputed =missing_NA[-1] )
imputed_1 <- data.frame(dataset = "imputed_1", Length = large_se_df_1$misl_imp[[1]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[1]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[1]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[1]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[1]]$datasets$Whole_Weight_Pred[-1], imputed =missing_NA[-1])
imputed_2 <- data.frame(dataset = "imputed_2", Length = large_se_df_1$misl_imp[[2]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[2]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[2]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[2]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[2]]$datasets$Whole_Weight_Pred[-1], imputed =missing_NA[-1])
imputed_3 <- data.frame(dataset = "imputed_3", Length = large_se_df_1$misl_imp[[3]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[3]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[3]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[3]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[3]]$datasets$Whole_Weight_Pred[-1], imputed =missing_NA[-1])
imputed_4 <- data.frame(dataset = "imputed_4", Length = large_se_df_1$misl_imp[[4]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[4]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[4]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[4]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[4]]$datasets$Whole_Weight_Pred[-1], imputed =missing_NA[-1])
imputed_5 <- data.frame(dataset = "imputed_5", Length = large_se_df_1$misl_imp[[5]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[5]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[5]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[5]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[5]]$datasets$Whole_Weight_Pred[-1], imputed =missing_NA[-1])
View(imputed_5)
combined_all <- rbind(melt(dataset_original, id = "dataset"), melt(imputed_1, id = "dataset"), melt(imputed_2, id = "dataset"), melt(imputed_3, id = "dataset"), melt(imputed_4, id = "dataset"),melt(imputed_5, id = "dataset") )
View(combined_all)
View(melt(dataset_original, id = "dataset"))
imputed =missing_NA[-1]*6
length(imputed =missing_NA[-1] * 6)
imputed =missing_NA[-1]
imputed
length(imputed * 6)
length(imputed)*6
length(imputed)*6 * 5
nrow(combined_all)
length(imputed)*6 * 6
dataset_original <- data.frame(dataset = "original", Length = abalone_model_predictions$Length , Diameter =  abalone_model_predictions$Diameter, Height = abalone_model_predictions$Height , Older_12= abalone_model_predictions$Older_12, Whole_Weight_Pred = abalone_model_predictions$Whole_Weight_Pred)
imputed_1 <- data.frame(dataset = "imputed_1", Length = large_se_df_1$misl_imp[[1]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[1]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[1]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[1]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[1]]$datasets$Whole_Weight_Pred[-1])
imputed_2 <- data.frame(dataset = "imputed_2", Length = large_se_df_1$misl_imp[[2]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[2]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[2]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[2]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[2]]$datasets$Whole_Weight_Pred[-1])
imputed_3 <- data.frame(dataset = "imputed_3", Length = large_se_df_1$misl_imp[[3]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[3]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[3]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[3]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[3]]$datasets$Whole_Weight_Pred[-1])
imputed_4 <- data.frame(dataset = "imputed_4", Length = large_se_df_1$misl_imp[[4]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[4]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[4]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[4]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[4]]$datasets$Whole_Weight_Pred[-1])
imputed_5 <- data.frame(dataset = "imputed_5", Length = large_se_df_1$misl_imp[[5]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[5]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[5]]$datasets$Height[-1] , Older_12= large_se_df_1$misl_imp[[5]]$datasets$Older_12[-1], Whole_Weight_Pred = large_se_df_1$misl_imp[[5]]$datasets$Whole_Weight_Pred[-1])
combined_all <- rbind(melt(dataset_original, id = "dataset"), melt(imputed_1, id = "dataset"), melt(imputed_2, id = "dataset"), melt(imputed_3, id = "dataset"), melt(imputed_4, id = "dataset"),melt(imputed_5, id = "dataset") )
combined_all <- rbind(melt(dataset_original, id = "dataset"), melt(imputed_1, id = "dataset"), melt(imputed_2, id = "dataset"), melt(imputed_3, id = "dataset"), melt(imputed_4, id = "dataset"),melt(imputed_5, id = "dataset") )
combined_all$imputed <- missing_NA[-1]
combined_all %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(variable~.) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
View(combined_all)
combined_all %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(variable~dataset) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
combined_all %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = variable))+
geom_histogram() +
facet_grid(dataset~variable) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
combined_all %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = dataset))+
geom_histogram() +
facet_grid(dataset~variable) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
dataset_original <- data.frame(dataset = "original", Length = abalone_model_predictions$Length , Diameter =  abalone_model_predictions$Diameter, Height = abalone_model_predictions$Height , Whole_Weight_Pred = abalone_model_predictions$Whole_Weight_Pred)
imputed_1 <- data.frame(dataset = "imputed_1", Length = large_se_df_1$misl_imp[[1]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[1]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[1]]$datasets$Height[-1] , Whole_Weight_Pred = large_se_df_1$misl_imp[[1]]$datasets$Whole_Weight_Pred[-1])
imputed_2 <- data.frame(dataset = "imputed_2", Length = large_se_df_1$misl_imp[[2]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[2]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[2]]$datasets$Height[-1] , Whole_Weight_Pred = large_se_df_1$misl_imp[[2]]$datasets$Whole_Weight_Pred[-1])
imputed_3 <- data.frame(dataset = "imputed_3", Length = large_se_df_1$misl_imp[[3]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[3]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[3]]$datasets$Height[-1] , Whole_Weight_Pred = large_se_df_1$misl_imp[[3]]$datasets$Whole_Weight_Pred[-1])
imputed_4 <- data.frame(dataset = "imputed_4", Length = large_se_df_1$misl_imp[[4]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[4]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[4]]$datasets$Height[-1] , Whole_Weight_Pred = large_se_df_1$misl_imp[[4]]$datasets$Whole_Weight_Pred[-1])
imputed_5 <- data.frame(dataset = "imputed_5", Length = large_se_df_1$misl_imp[[5]]$datasets$Length[-1] , Diameter =  large_se_df_1$misl_imp[[5]]$datasets$Diameter[-1], Height = large_se_df_1$misl_imp[[5]]$datasets$Height[-1] , Whole_Weight_Pred = large_se_df_1$misl_imp[[5]]$datasets$Whole_Weight_Pred[-1])
combined_all <- rbind(melt(dataset_original, id = "dataset"), melt(imputed_1, id = "dataset"), melt(imputed_2, id = "dataset"), melt(imputed_3, id = "dataset"), melt(imputed_4, id = "dataset"),melt(imputed_5, id = "dataset") )
combined_all$imputed <- missing_NA[-1]
combined_all %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = dataset))+
geom_histogram() +
facet_grid(dataset~variable) +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
combined_all %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = dataset))+
geom_histogram() +
facet_grid(dataset~variable, scales = "free") +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
combined_all %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = dataset))+
geom_histogram() +
facet_grid(variable~dataset = "free") +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
combined_all %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = dataset))+
geom_histogram() +
facet_grid(variable~dataset, scale = "free") +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
combined_all %>%
filter(imputed) %>%
ggplot(aes(x =value, fill = dataset))+
geom_histogram() +
facet_grid(dataset~variable, scale = "free") +
ggtitle("One Imputed Dataset Predicts Closely") +
theme_bw()
lambda
# This is the non-problematic one
dfcom = 4170
lambda_noprob <- (1 + 1 / misl_pool_no_prob$pooled$m) * misl_pool_no_prob$pooled$b / misl_pool_no_prob$pooled$t
lambda_noprob[lambda_noprob] <- 1e-04
dfold_noprob <- (misl_pool_no_prob$pooled$m - 1) / lambda_noprob^2
dfobs_noprob <- (dfcom + 1) / (dfcom + 3) * dfcom * (1 - lambda_noprob)
dfold_noprob * dfobs_noprob / (dfold_noprob + dfobs_noprob)
lambda_noprob
dfold_noprob * dfobs_noprob / (dfold_noprob + dfobs_noprob)
summary(mice::pool(misl_fit_no_prob), conf.int = TRUE)
summary(mice::pool(misl_fit_prob), conf.int = TRUE)
lambda
lambda_noprob
dfcom = 4170
lambda <- (1 + 1 / misl_pool_prob$pooled$m) * misl_pool_prob$pooled$b / misl_pool_prob$pooled$t
lambda[lambda < 1e-04] <- 1e-04
dfold <- (misl_pool_prob$pooled$m - 1) / lambda^2
dfobs <- (dfcom + 1) / (dfcom + 3) * dfcom * (1 - lambda)
dfold * dfobs / (dfold + dfobs)
lambda
dfcom = 4170
lambda_noprob <- (1 + 1 / misl_pool_no_prob$pooled$m) * misl_pool_no_prob$pooled$b / misl_pool_no_prob$pooled$t
lambda_noprob[lambda_noprob] <- 1e-04
dfold_noprob <- (misl_pool_no_prob$pooled$m - 1) / lambda_noprob^2
dfobs_noprob <- (dfcom + 1) / (dfcom + 3) * dfcom * (1 - lambda_noprob)
dfold_noprob * dfobs_noprob / (dfold_noprob + dfobs_noprob)
lambda_noprob
misl_pool_no_prob$pooled$b
misl_pool_prob$pooled$b
misl_fit_prob <- lapply(large_se_df_1$misl_imp, function(y){
lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12, data = y$datasets)
})
misl_pool_prob <- mice::pool(misl_fit_prob)
misl_pool_prob_summary <- summary(mice::pool(misl_fit_prob), conf.int = TRUE)
misl_fit_no_prob <- lapply(large_se_df_1$misl_imp[c(1:3,5)], function(y){
lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12, data = y$datasets)
})
misl_pool_no_prob <- mice::pool(misl_fit_no_prob)
misl_pool_no_prob_summary <- summary(mice::pool(misl_fit_no_prob), conf.int = TRUE)
dfcom = 4170
lambda_noprob <- (1 + 1 / misl_pool_no_prob$pooled$m) * misl_pool_no_prob$pooled$b / misl_pool_no_prob$pooled$t
lambda_noprob[lambda_noprob] <- 1e-04
dfold_noprob <- (misl_pool_no_prob$pooled$m - 1) / lambda_noprob^2
dfobs_noprob <- (dfcom + 1) / (dfcom + 3) * dfcom * (1 - lambda_noprob)
dfold_noprob * dfobs_noprob / (dfold_noprob + dfobs_noprob)
dfcom = 4170
lambda <- (1 + 1 / misl_pool_prob$pooled$m) * misl_pool_prob$pooled$b / misl_pool_prob$pooled$t
lambda[lambda < 1e-04] <- 1e-04
dfold <- (misl_pool_prob$pooled$m - 1) / lambda^2
dfobs <- (dfcom + 1) / (dfcom + 3) * dfcom * (1 - lambda)
dfold * dfobs / (dfold + dfobs)
lambda
lambda_noprob
misl_pool_no_prob$pooled$b
misl_pool_no_prob$pooled$b
misl_pool_prob$pooled$b
misl_pool_prob$pooled$t
misl_pool_no_prob$pooled$t
lambda_noprob
lambda
summary(mice::pool(misl_fit_prob), conf.int = TRUE)
summary(mice::pool(misl_fit_prob, df = 999999999999999), conf.int = TRUE)
misl_pool_prob$pooled$b
misl_pool_no_prob$pooled$b
misl_pool_no_prob$pooled$t
misl_pool_prob$pooled$t
misl_fit_no_prob <- lapply(large_se_df_1$misl_imp[c(1:3,5)], function(y){
lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12, data = y$datasets)
})
misl_pool_no_prob <- mice::pool(misl_fit_no_prob)
misl_pool_no_prob_summary <- summary(mice::pool(misl_fit_no_prob), conf.int = TRUE)
summary(mice::pool(misl_fit_no_prob), conf.int = TRUE)
summary(mice::pool(misl_fit_prob), conf.int = TRUE)
# PRoblem dataset
summary(lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12,data = large_se_df_1$misl_imp[[4]]$datasets))
lambda
misl_pool_prob$pooled$b
summary(mice::pool(misl_fit_prob), conf.int = TRUE)
summary(mice::pool(misl_fit_prob), conf.int = TRUE)
summary(mice::pool(misl_fit_prob, dfcom = 999999999999999), conf.int = TRUE)
?mice:::pool
lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12,data = large_se_df_1$misl_imp[[4]]$datasets)
glance(lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12,data = large_se_df_1$misl_imp[[4]]$datasets))
summary(mice::pool(misl_fit_prob, dfcom = 4170), conf.int = TRUE)
mice_fit_prob <- lapply(large_se_df_1$mice_imp, function(y){
lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12, data = y$datasets)
})
mice_fit_prob <- lapply(large_se_df_1$mice_imp, function(y){
lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12, data = y$datasets)
})
mice
with(data = large_se_df_1$mice_imp, exp =lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12 )
)
mice_fit_prob <- with(data = large_se_df_1$mice_imp, exp =lm(Whole_Weight_Pred ~ Sex + Length + Diameter + Height + Older_12 )
)
mice_fit_prob
summary(mice::pool(mice_fit_prob), conf.int = TRUE)
summary(mice::pool(mice_fit_prob, dfcom = 4170), conf.int = TRUE)
summary(mice::pool(mice_fit_prob, dfcom = 99999999), conf.int = TRUE)
summary(mice::pool(mice_fit_prob), conf.int = TRUE)
